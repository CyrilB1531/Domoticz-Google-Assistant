<html>

<head>
<title>Domoticz Google Assistant</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=0.86, maximum-scale=3.0, minimum-scale=0.86">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
<link rel="stylesheet" href="static/css/material-dashboard.css" />

<style>
body{
	margin:0;
	background:#c8c8c8;
}
*,:after,:before{box-sizing:border-box}
.clearfix:after,.clearfix:before{content:'';display:table}
.clearfix:after{clear:both;display:block}

.login-wrap{
	width:100%;
	margin:auto;
	max-width:525px;
	min-height:670px;
	position:relative;
	background:url(static/img/google-home-ecosystem.jpg) no-repeat center;
	box-shadow:0 12px 15px 0 rgba(0,0,0,.24),0 17px 50px 0 rgba(0,0,0,.19);
}
.login-html{
	width:100%;
	height:100%;
	position:absolute;
	padding:90px 70px 50px 70px;
	background:rgba(148,0,211,.4);
}

</style>

</head>
<div class="login-wrap">
	<div class="login-html">
        <div class="col-md-12">
          <div class="card">
            <div class="card-header card-header-primary">
              <h4 class="card-title ">Login</h4>
              <p class="card-category">Domoticz-Google-Assistant</p>
            </div>
            <div class="card-body">
            <form action='login' method='post' id='loginform'>
				<div class="form-group">
					<label for="username">Username</label>
					<input id="username" type="text" class="form-control">
				</div>
				<div class="form-group">
					<label for="userpass">Password</label>
					<input id="userpass" type="password" class="form-control" data-type="password">
				</div>
                        <input type="hidden" name="redirect">
                        <input type="hidden" name="client_id">
                        <input type="hidden" name="redirect_uri">
                        <input type="hidden" name="state">
                        <input type="hidden" name="username">
                        <input type="hidden" name="password">
				<div class="group">
					<input type="submit" class="btn btn-primary" value="Sign In" OnClick="formSubmit()">
				</div>
				<div class="hr"></div>
				<div class="foot-lnk">
					<a href="https://github.com/DewGew/Domoticz-Google-Assistant">Google Assistant for Domoticz on Github</a>
				</div>
            </form>
		</div>
        </div>
        </div>
	</div>
</div>
<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src="https://unpkg.com/popper.js@1.12.6/dist/umd/popper.js" integrity="sha384-fA23ZRQ3G/J53mElWqVJEGJzU0sTs+SvzG8fXVWP+kJQ1lwFAOkcUOysnlKJC33U" crossorigin="anonymous"></script>
<script src="https://unpkg.com/bootstrap-material-design@4.1.1/dist/js/bootstrap-material-design.js" integrity="sha384-CauSuKpEqAFajSpkdjv3z9t8E7RlpJ1UP0lKM/+NdtSarroVKu069AlsRPKkFBz9" crossorigin="anonymous"></script>
<script src="static/js/plugins/perfect-scrollbar.jquery.min.js"></script>
<script src="static/js/material-dashboard.js"></script>

	<script>
        function getUrlParameters () {
            // Get each parameter
            let query = window.location.search.substr(1);
            // Split each parameter into a key-value pair
            let keyValues = query.split('&');
            let parameterMap = new Map();
            for (let i in keyValues) {
                // Split into <key>=<value>
                let param = keyValues[i];
                let splitParam = param.split('=');
                parameterMap.set(splitParam[0], splitParam[1]);
            }
            return parameterMap;
        }

        function formSubmit () {
            // Get URL parameters
            let params = getUrlParameters();
            // Set each hidden input from a value obtained from the URL
            document.querySelector('[name="redirect"]').value = params.get('redirect');
            document.querySelector('[name="redirect_uri"]').value = params.get('redirect_uri');
            document.querySelector('[name="client_id"]').value = params.get('client_id');
            document.querySelector('[name="state"]').value = params.get('state');
            document.querySelector('[name="username"]').value = document.querySelector('input[id="username"]').value;
            document.querySelector('[name="password"]').value = document.querySelector('input[id="userpass"]').value;
            document.querySelector('#loginform').submit();
        }
    </script> 
	
</html>
